<ion-header>
  <ion-navbar>
    <ion-title>{{action}} Service</ion-title>
    <ion-buttons end>
      <button ion-button icon-only (click)="saveService()">
        save
      </button>
      <button ion-button icon-only>
        <ion-icon name="trash"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content >
  <ion-list inset>
    <ion-item>
      <ion-label class="item-name">NAME:</ion-label>
      <ion-input type="text" [(ngModel)]="serviceItem.name"></ion-input>
    </ion-item>
    <ion-item>
      <ion-label class="item-name">PRICE($):</ion-label>
      <ion-input type="text" [(ngModel)]="serviceItem.price"></ion-input>
    </ion-item>
     <ion-item>
        <ion-label>CATEGORIES:</ion-label>
        <ion-select [(ngModel)]="serviceItem.categoryIDs"  multiple="true">   
          <ion-option  *ngFor="let item of categories ; let idx=index" value={{item._id}}>{{item.name}}</ion-option> 
        </ion-select>
       
    </ion-item>
     <ion-item>
       <button ion-button (click)="selectIcon()">Select Icon</button>
      <span *ngIf="selectedIcon"><sp-icon [icon]="serviceItem.icon.name"></sp-icon>&nbsp;{{ serviceItem.icon.name }}</span>
     </ion-item>      
  </ion-list>

  <!-- Default Price Book  -->
  <ion-grid>
    <ion-row>
      <ion-col col-md-12 class="pull-left"><h3>Default Price Book</h3></ion-col>
    </ion-row>    
    <ion-row>
      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>Supply price</ion-label>
          <ion-input type="number" [(ngModel)]="defaultPriceBook.item.supplyPrice" (change)="onSupplyPriceChange(defaultPriceBook)">
          </ion-input><br/>
          <small>Excluding Tax</small>
        </ion-item>
      </ion-col>

      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>x Markup (%)</ion-label>
          <ion-input type="number" [(ngModel)]="defaultPriceBook.item.markup" (change)="onMarkupChange(defaultPriceBook)">
          </ion-input>
        </ion-item>
      </ion-col>

      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>= Retail Price (Encl.)</ion-label>
          <ion-input type="number" [(ngModel)]="defaultPriceBook.item.retailPrice" (change)="onRetailPriceChange(defaultPriceBook)" required></ion-input>
          <br/>
          <small>Excluding Tax</small>
        </ion-item>
      </ion-col>

      <ion-col col-md-3>
        <ion-item item-content>
          <ion-label color="primary" stacked>+ Sales Tax</ion-label>
          <ion-select [(ngModel)]="defaultPriceBook.tax" (ionChange)="onSalesTaxChange(defaultPriceBook)">
            <ion-option [value]="tax" *ngFor="let tax of salesTaxes">{{ tax.name }} <small>({{ tax.rate }}%)</small></ion-option>
          </ion-select><br/>
          <small>Currently</small>
        </ion-item>
      </ion-col>

      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>= Retail Price (Incl.)</ion-label>
          <ion-input type="number" 
            [(ngModel)]="defaultPriceBook.item.inclusivePrice"
            (change)="onRetailPriceTaxInclusiveChange(defaultPriceBook)">
          </ion-input>
          <br/>
          <small>Including Tax</small>
        </ion-item>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- Normal Price Books -->
  <ion-grid>
    <ion-row>
      <ion-col col-md-12 class="pull-left"><h3>Price Books</h3></ion-col>
    </ion-row>
    <ion-row *ngFor="let priceBook of priceBooks; let i = index">
      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>Supply price</ion-label>
          <ion-input type="number" [(ngModel)]="priceBook.item.supplyPrice" (change)="onSupplyPriceChange(priceBook)">
          </ion-input><br/>
          <small>Excluding Tax</small>
        </ion-item>
      </ion-col>

      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>x Markup (%)</ion-label>
          <ion-input type="number" [(ngModel)]="priceBook.item.markup" (change)="onMarkupChange(priceBook)">
          </ion-input>
        </ion-item>
      </ion-col>

      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>= Retail Price (Excl.)</ion-label>
          <ion-input type="number" [(ngModel)]="priceBook.item.retailPrice" (change)="onRetailPriceChange(priceBook)" required></ion-input>
          <br/>
          <small>Excluding Tax</small>
        </ion-item>
      </ion-col>

      <ion-col col-md-3>
        <ion-item item-content>
          <ion-label color="primary" stacked>+ Sales Tax</ion-label>
          <ion-select [(ngModel)]="priceBook.tax" (ionChange)="onSalesTaxChange(priceBook)">
            <ion-option [value]="tax" *ngFor="let tax of salesTaxes">{{ tax.name }} {{ tax.noOfTaxes ? tax.noOfTaxes.length : '' }} <small>({{ tax.rate }}%)</small></ion-option>
          </ion-select><br/>
          <small>Currently</small>
        </ion-item>
      </ion-col>

      <ion-col col-md-2>
        <ion-item item-content>
          <ion-label color="primary" stacked>= Retail Price (Incl.)</ion-label>
          <ion-input type="number" 
            [(ngModel)]="priceBook.item.inclusivePrice"
            (change)="onRetailPriceTaxInclusiveChange(priceBook)">
          </ion-input>
          <br/>
          <small>Including Tax</small>
        </ion-item>
      </ion-col>

    </ion-row>    
  </ion-grid>

</ion-content> 
 